(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{77208:function(e,t,s){Promise.resolve().then(s.bind(s,89373))},36304:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return l}});let r=s(21024),a=r._(s(2265)),l=a.default.createContext(null)},89373:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(57437),a=s(2265),l=s(24033),n=s(16691),i=s.n(n),o=s(70680),c=s(12431),d=s(60345),m=s(54829),u=s(62601);let x=u.env.SIMPLYRETS_API_KEY,p=u.env.SIMPLYRETS_API_SECRET;async function h(e){try{var t;let{data:s,error:r}=await c.O.from("properties").select("*").eq("mls_id",e).single();if(r&&"PGRST116"!==r.code)throw console.error("Error fetching property from Supabase:",r),r;if(s)return s;let a=await m.Z.get("".concat("https://api.simplyrets.com","/properties/").concat(e),{auth:{username:x,password:p}}),l={id:(t=a.data).mlsId,mls_id:t.mlsId,address:t.address.full,city:t.address.city,state:t.address.state,zip:t.address.postalCode,price:t.listPrice,beds:t.property.bedrooms,baths:t.property.bathsFull+(t.property.bathsHalf?.5*t.property.bathsHalf:0),sqft:t.property.area,lot_size:t.property.lotSize,year_built:t.property.yearBuilt,property_type:t.property.type,description:t.remarks,photos_json:t.photos?t.photos.map(e=>e.url):[],source_url:"/properties/".concat(t.mlsId),status:t.mls.status,geo_location:t.geo?{lat:t.geo.lat,lng:t.geo.lng}:void 0,last_updated:new Date().toISOString()};return await c.O.from("properties").upsert(l,{onConflict:"mls_id"}),l}catch(t){return console.error("Error fetching property ".concat(e,":"),t),null}}function f(){let{id:e}=(0,l.useParams)(),{user:t}=(0,o.a)(),[s,n]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),[x,p]=(0,a.useState)(null),[f,g]=(0,a.useState)(!1),[j,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)(0),[N,w]=(0,a.useState)(20),[_,S]=(0,a.useState)(7),[k,P]=(0,a.useState)(30),[E,C]=(0,a.useState)(null),[I,M]=(0,a.useState)(null);(0,a.useEffect)(()=>{let s=async()=>{u(!0),p(null);try{let s=await h(e);if(!s){p("Property not found"),u(!1);return}let{data:r}=await c.O.from("fmr_data").select("*").eq("zip_code",s.zip).order("year",{ascending:!1}).limit(1),a=null;if(r&&r.length>0)switch(s.beds){case 0:a=r[0].beds_0;break;case 1:a=r[0].beds_1;break;case 2:a=r[0].beds_2;break;case 3:a=r[0].beds_3;break;default:a=r[0].beds_4}let l=s.price,i=.07/12,o=Math.round(.8*l*i*Math.pow(1+i,360)/(Math.pow(1+i,360)-1)+.02*l/12),d=null!==a?a-o:null,m={...s,fair_market_rent:a,estimated_mortgage:o,estimated_cash_flow:d};if(n(m),C(o),M(d),t){let{data:e}=await c.O.from("favorite_properties").select("id").eq("user_id",t.id).eq("property_id",s.id).limit(1);g(!!e&&e.length>0)}}catch(e){console.error("Error fetching property details:",e),p("Failed to fetch property details. Please try again later.")}finally{u(!1)}};e&&s()},[e,t]),(0,a.useEffect)(()=>{if(s){let e=s.price,t=N/100,r=_/100,a=12*k,l=r/12,n=Math.round(e*(1-t)*l*Math.pow(1+l,a)/(Math.pow(1+l,a)-1)+.02*e/12);C(n);let i=null!==s.fair_market_rent?s.fair_market_rent-n:null;M(i)}},[s,N,_,k]);let O=async()=>{if(!t){window.location.href="/login?redirectUrl=/properties/".concat(e);return}if(s){b(!0);try{if(f){let{error:e}=await c.O.from("favorite_properties").delete().eq("user_id",t.id).eq("property_id",s.id);if(e)throw e}else{let{error:e}=await c.O.from("favorite_properties").insert({user_id:t.id,property_id:s.id});if(e)throw e}g(!f)}catch(e){console.error("Error toggling favorite status:",e)}finally{b(!1)}}};if(m)return(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,r.jsx)("div",{className:"flex justify-center my-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})});if(x||!s)return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:x||"Property not found"}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("a",{href:"/properties",className:"btn btn-primary inline-block",children:"Back to Properties"})})]});let F=I&&I>0?"positive":I&&I<0?"negative":"neutral";return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("a",{href:"/properties",className:"text-primary hover:text-primary/80 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to properties"]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"relative h-96 w-full rounded-lg overflow-hidden mb-4",children:[s.photos_json&&s.photos_json.length>0?(0,r.jsx)(i(),{src:s.photos_json[y],alt:"".concat(s.address," - Image ").concat(y+1),fill:!0,className:"object-cover"}):(0,r.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-gray-200",children:(0,r.jsx)("span",{className:"text-gray-400",children:"No image available"})}),(0,r.jsx)("button",{onClick:O,disabled:j,className:"absolute top-4 right-4 p-2 bg-white rounded-full shadow-md hover:bg-gray-100 focus:outline-none z-10","aria-label":f?"Remove from favorites":"Add to favorites",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:f?"currentColor":"none",stroke:"currentColor",className:"w-6 h-6 ".concat(f?"text-red-500":"text-gray-400"),children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),s.photos_json&&s.photos_json.length>1&&(0,r.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:s.photos_json.map((e,t)=>(0,r.jsx)("button",{onClick:()=>v(t),className:"flex-shrink-0 relative h-20 w-20 rounded-md overflow-hidden ".concat(y===t?"ring-2 ring-primary":""),children:(0,r.jsx)(i(),{src:e,alt:"".concat(s.address," - Thumbnail ").concat(t+1),fill:!0,className:"object-cover"})},t))})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:s.address}),(0,r.jsxs)("p",{className:"text-xl text-gray-700 mb-4",children:[s.city,", ",s.state," ",s.zip]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("p",{className:"text-3xl font-bold text-primary",children:(0,d.xG)(s.price)}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Beds"}),(0,r.jsx)("p",{className:"font-semibold",children:s.beds})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Baths"}),(0,r.jsx)("p",{className:"font-semibold",children:s.baths})]}),s.sqft&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Sq Ft"}),(0,r.jsx)("p",{className:"font-semibold",children:(0,d.uf)(s.sqft)})]}),s.year_built&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Year"}),(0,r.jsx)("p",{className:"font-semibold",children:s.year_built})]})]})]})]}),s.description&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Description"}),(0,r.jsx)("div",{className:"prose max-w-none",children:(0,r.jsx)("p",{className:"text-gray-700 whitespace-pre-line",children:s.description})})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Property Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Property Type"}),(0,r.jsx)("p",{className:"font-medium",children:s.property_type||"Not specified"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Status"}),(0,r.jsx)("p",{className:"font-medium capitalize",children:s.status||"Active"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"MLS ID"}),(0,r.jsx)("p",{className:"font-medium",children:s.mls_id||"Not available"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Last Updated"}),(0,r.jsx)("p",{className:"font-medium",children:(0,d.p6)(s.last_updated||new Date)})]}),s.lot_size&&(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Lot Size"}),(0,r.jsxs)("p",{className:"font-medium",children:[(0,d.uf)(s.lot_size)," sq ft"]})]})]})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden sticky top-8",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Financial Analysis"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Section 8 Fair Market Rent"}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,r.jsxs)("p",{className:"text-gray-700 text-sm mb-1",children:["Estimated FMR for ",s.beds," bedroom in ",s.zip]}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:s.fair_market_rent?(0,d.xG)(s.fair_market_rent)+"/mo":"No data available"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Mortgage Calculator"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Down Payment (%)"}),(0,r.jsx)("input",{type:"range",min:"5",max:"50",step:"5",value:N,onChange:e=>w(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"5%"}),(0,r.jsxs)("span",{children:[N,"%"]}),(0,r.jsx)("span",{children:"50%"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interest Rate (%)"}),(0,r.jsx)("input",{type:"range",min:"3",max:"12",step:"0.1",value:_,onChange:e=>S(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,r.jsx)("span",{children:"3%"}),(0,r.jsxs)("span",{children:[_.toFixed(1),"%"]}),(0,r.jsx)("span",{children:"12%"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Term (years)"}),(0,r.jsxs)("select",{value:k,onChange:e=>P(parseInt(e.target.value)),className:"input w-full",children:[(0,r.jsx)("option",{value:"15",children:"15 years"}),(0,r.jsx)("option",{value:"20",children:"20 years"}),(0,r.jsx)("option",{value:"30",children:"30 years"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Investment Summary"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Purchase Price"}),(0,r.jsx)("p",{className:"font-bold text-lg",children:(0,d.xG)(s.price)})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("p",{className:"text-gray-500 text-sm",children:["Down Payment (",N,"%)"]}),(0,r.jsx)("p",{className:"font-medium",children:(0,d.xG)(s.price*(N/100))})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Estimated Monthly Payment (PITI)"}),(0,r.jsx)("p",{className:"font-medium",children:E?(0,d.xG)(E)+"/mo":"Calculating..."}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Includes principal, interest, taxes and insurance"})]}),(0,r.jsxs)("div",{className:"p-4 rounded-lg ".concat({positive:"bg-green-50",negative:"bg-red-50",neutral:"bg-gray-50"}[F]),children:[(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Estimated Monthly Cash Flow"}),(0,r.jsx)("p",{className:"text-xl font-bold ".concat({positive:"text-green-600",negative:"text-red-600",neutral:"text-gray-600"}[F]),children:null!==I?(0,d.xG)(I)+"/mo":"No FMR data available"})]}),null!==I&&I>0&&(0,r.jsx)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:(0,r.jsx)("p",{className:"font-medium text-green-800",children:"This property may have positive cash flow based on Section 8 Fair Market Rent!"})})]})]})]})})})]})]})}},70680:function(e,t,s){"use strict";s.d(t,{H:function(){return i},a:function(){return o}});var r=s(57437),a=s(2265),l=s(12431);let n=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,m]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,t)=>{var s;c(t),i(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),m(!1)});return l.O.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;c(s),i(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),m(!1)}),()=>{e.unsubscribe()}},[]);let u=async(e,t)=>{try{let{error:s}=await l.O.auth.signInWithPassword({email:e,password:t});if(s)throw s}catch(e){throw console.error("Error signing in:",e),e}},x=async(e,t)=>{try{let{error:s}=await l.O.auth.signUp({email:e,password:t});if(s)throw s}catch(e){throw console.error("Error signing up:",e),e}},p=async()=>{try{let{error:e}=await l.O.auth.signOut();if(e)throw e}catch(e){throw console.error("Error signing out:",e),e}};return(0,r.jsx)(n.Provider,{value:{user:s,session:o,isLoading:d,signIn:u,signUp:x,signOut:p},children:t})}function o(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},12431:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var r=s(84756);let a="https://mock-supabase-url.supabase.co",l="mock-anon-key-for-demo-purposes-only";if(!a||!l)throw Error("Missing Supabase environment variables. Please check your .env.local file.");let n=(0,r.eI)(a,l)},60345:function(e,t,s){"use strict";function r(e){if(null==e)return"$0";let t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0});return t.format(e)}function a(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}function l(e){return new Intl.NumberFormat("en-US").format(e)}s.d(t,{p6:function(){return a},uf:function(){return l},xG:function(){return r}})},24033:function(e,t,s){e.exports=s(50094)}},function(e){e.O(0,[36,829,691,971,472,744],function(){return e(e.s=77208)}),_N_E=e.O()}]);
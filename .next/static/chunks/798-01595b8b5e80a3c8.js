"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{93480:function(e,n,t){t.d(n,{g:function(){return o}});var a=t(2265),r=t(36572),c=function(e){var n=e.title,t=(0,r.Ht)("MenuIcon").t;return a.createElement("svg",{"data-testid":"menu-icon",viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg"},a.createElement("title",null,null!=n?n:t("Menu")),a.createElement("path",{d:"M0 88C0 74.75 10.75 64 24 64H424C437.3 64 448 74.75 448 88C448 101.3 437.3 112 424 112H24C10.75 112 0 101.3 0 88zM0 248C0 234.7 10.75 224 24 224H424C437.3 224 448 234.7 448 248C448 261.3 437.3 272 424 272H24C10.75 272 0 261.3 0 248zM424 432H24C10.75 432 0 421.3 0 408C0 394.7 10.75 384 24 384H424C437.3 384 448 394.7 448 408C448 421.3 437.3 432 424 432z",fill:"currentColor"}))},i=t(8229),l=t(22439),s=t(99428),u=t(11493),o=a.memo(function(e){var n=e.Avatar,t=void 0===n?i.q:n,o=e.MenuIcon,d=e.image,h=e.live,v=e.title,f=(0,s.JN)("ChannelHeader"),m=f.channel,p=f.watcher_count,E=(0,u.mx)("ChannelHeader").openMobileNav,g=(0,r.Ht)("ChannelHeader").t,_=(0,l.y)({channel:m,overrideImage:d,overrideTitle:v}),C=_.displayImage,L=_.displayTitle,b=(null==m?void 0:m.data)||{},w=b.member_count,S=b.subtitle;return a.createElement("div",{className:"str-chat__header-livestream str-chat__channel-header"},a.createElement("button",{"aria-label":"Menu",className:"str-chat__header-hamburger",onClick:E},a.createElement(void 0===o?c:o,null)),a.createElement(t,{image:C,name:L,shape:"rounded",size:(null==m?void 0:m.type)==="commerce"?60:40}),a.createElement("div",{className:"str-chat__header-livestream-left str-chat__channel-header-end"},a.createElement("p",{className:"str-chat__header-livestream-left--title str-chat__channel-header-title"},L," ",h&&a.createElement("span",{className:"str-chat__header-livestream-left--livelabel"},g("live"))),S&&a.createElement("p",{className:"str-chat__header-livestream-left--subtitle"},S),a.createElement("p",{className:"str-chat__header-livestream-left--members str-chat__channel-header-info"},!h&&!!w&&w>0&&a.createElement(a.Fragment,null,g("{{ memberCount }} members",{memberCount:w}),","," "),g("{{ watcherCount }} online",{watcherCount:p}))))})},82434:function(e,n,t){t.d(n,{G:function(){return ev}});var a,r,c=t(50044),i=t(2265),l=t(57042),s=t(36572),u=function(){return i.createElement("svg",{height:"78px",version:"1.1",viewBox:"0 0 78 78",width:"78px",xmlns:"http://www.w3.org/2000/svg"},i.createElement("title",null,"Connection Error"),i.createElement("g",{fill:"none",fillRule:"evenodd",id:"Interactions",stroke:"none",strokeWidth:"1"},i.createElement("g",{fill:"#CF1F25",id:"Connection-Error-_-Connectivity",transform:"translate(-270.000000, -30.000000)"},i.createElement("g",{id:"109-network-connection",transform:"translate(270.000000, 30.000000)"},i.createElement("path",{d:"M66.4609744,11.414231 C81.6225232,26.5757798 81.6225232,51.157545 66.4609744,66.3188467 C51.2994256,81.4803954 26.7176604,81.4803954 11.5563587,66.3188467 C-3.60519004,51.1572979 -3.60519004,26.5755327 11.5563587,11.414231 C26.7179075,-3.74731776 51.2996727,-3.74731776 66.4609744,11.414231 Z M54.7853215,45.8823776 L54.7853215,40.5882574 C54.7853215,39.613638 53.9952341,38.8235506 53.0206147,38.8235506 L44.9576695,38.8235506 L41.428256,42.3529641 L51.255555,42.3529641 L51.255555,45.8823776 L54.7853215,45.8823776 Z M40.6659027,43.1153174 L37.8988425,45.8823776 L40.6659027,45.8823776 L40.6659027,43.1153174 Z M51.1764962,56.4702653 L58.2353232,56.4702653 C59.2099355,56.4702653 60.00003,55.6801708 60.00003,54.7055585 L60.00003,51.176145 C60.00003,50.2015327 59.2099355,49.4114382 58.2353232,49.4114382 L51.1764962,49.4114382 C50.2018839,49.4114382 49.4117894,50.2015327 49.4117894,51.176145 L49.4117894,54.7055585 C49.4117894,55.6801708 50.2018839,56.4702653 51.1764962,56.4702653 Z M35.2941353,56.4702653 L42.3529624,56.4702653 C43.3275746,56.4702653 44.1176691,55.6801708 44.1176691,54.7055585 L44.1176691,51.176145 C44.1176691,50.2015327 43.3275746,49.4114382 42.3529624,49.4114382 L35.2941353,49.4114382 C34.319523,49.4114382 33.5294285,50.2015327 33.5294285,51.176145 L33.5294285,54.7055585 C33.5294285,55.6801708 34.319523,56.4702653 35.2941353,56.4702653 Z M56.6964989,19.0874231 C56.007381,18.3985134 54.8903216,18.3985134 54.2012036,19.087423 L45.882376,27.4062507 L45.882376,19.4117761 C45.882376,18.4371568 45.0922885,17.6470693 44.1176692,17.6470693 L33.5294286,17.6470693 C32.5548092,17.6470694 31.7647218,18.4371568 31.7647218,19.4117761 L31.7647218,30.0000167 C31.7647219,30.9746363 32.5548092,31.7647237 33.5294285,31.7647237 L41.5239031,31.7647237 L34.4650761,38.8235508 L24.7058947,38.8235508 C23.7312753,38.8235508 22.9411879,39.6136382 22.9411879,40.5882575 L22.9411879,45.8823778 L26.4706014,45.8823778 L26.4706014,42.3529643 L30.9356624,42.3529643 L23.8768354,49.4117914 L19.4117743,49.4117914 C18.4371549,49.4117914 17.6470675,50.2018788 17.6470675,51.1764981 L17.6470675,54.7059117 C17.6504049,54.9674302 17.7129076,55.2248042 17.8298886,55.4587302 L16.4456526,56.8429662 C15.7446193,57.5200453 15.7252005,58.6372282 16.4022825,59.3382615 C17.0793616,60.0392948 18.1965445,60.0587136 18.8975778,59.3816316 C18.9122847,59.3674273 18.9267436,59.3529684 18.940948,59.3382615 L56.6964963,21.5830662 C57.3856425,20.8939094 57.3856425,19.7765747 56.6964963,19.0874179 Z",id:"Combined-Shape"})))))},o=i.memo(function(e){var n=e.image,t=void 0===n?i.createElement(u,null):n,a=e.text,r=e.type,c=(0,s.Ht)("ChatDown").t;return i.createElement("div",{className:"str-chat__down"},i.createElement("div",{className:"str-chat__down-main"},"string"==typeof t?i.createElement("img",{alt:"Connection error","data-testid":"chatdown-img",src:t}):t,i.createElement("h1",null,void 0===r?"Error":r),i.createElement("h3",{"aria-live":"assertive"},a||c("Error connecting to chat, refresh the page to try again."))))}),d=function(){return i.createElement("div",{className:"str-chat__loading-channels-item str-chat__channel-preview-loading"},i.createElement("div",{className:"str-chat__loading-channels-avatar"}),i.createElement("div",{className:"str-chat__loading-channels-meta str-chat__channel-preview-end-loading"},i.createElement("div",{className:"str-chat__loading-channels-username"}),i.createElement("div",{className:"str-chat__loading-channels-status"})))},h=i.memo(function(){return i.createElement("div",{className:"str-chat__loading-channels"},i.createElement(d,null),i.createElement(d,null),i.createElement(d,null))}),v=function(e){var n=e.children,t=e.error,a=e.loading,r=e.LoadingErrorIndicator,c=e.LoadingIndicator;return(void 0===t?null:t)?i.createElement(void 0===r?o:r,{type:"Connection Error"}):a?i.createElement(void 0===c?h:c,null):i.createElement("div",{className:"str-chat__channel-list-messenger str-chat__channel-list-messenger-react"},i.createElement("div",{"aria-label":"Channel list",className:"str-chat__channel-list-messenger__main str-chat__channel-list-messenger-react__main",role:"listbox"},n))},f=t(11493),m=function(e,n){var t=(0,f.mx)("useChannelDeletedListener").client;(0,i.useEffect)(function(){var a=function(t){n&&"function"==typeof n?n(e,t):e(function(e){var n=e.findIndex(function(e){return e.cid===t.cid});return n<0||e.splice(n,1),(0,c.ev)([],e,!0)})};return t.on("channel.deleted",a),function(){t.off("channel.deleted",a)}},[n])},p=function(e,n){var t=(0,f.mx)("useChannelHiddenListener").client;(0,i.useEffect)(function(){var a=function(t){n&&"function"==typeof n?n(e,t):e(function(e){var n=e.findIndex(function(e){return e.cid===t.cid});return n<0||e.splice(n,1),(0,c.ev)([],e,!0)})};return t.on("channel.hidden",a),function(){t.off("channel.hidden",a)}},[n])},E=function(e,n,t){var a=(0,f.mx)("useChannelTruncatedListener").client;(0,i.useEffect)(function(){var r=function(a){e(function(e){return(0,c.ev)([],e,!0)}),n&&"function"==typeof n&&n(e,a),t&&t()};return a.on("channel.truncated",r),function(){a.off("channel.truncated",r)}},[n])},g=function(e,n,t){var a=(0,f.mx)("useChannelUpdatedListener").client;(0,i.useEffect)(function(){var r=function(a){e(function(e){var n,t,r,i,l,s,u=e.findIndex(function(e){var n;return e.cid===(null===(n=a.channel)||void 0===n?void 0:n.cid)});return u>-1&&a.channel?(e[u].data=(0,c.pi)((0,c.pi)({},a.channel),{hidden:null!==(t=null===(n=a.channel)||void 0===n?void 0:n.hidden)&&void 0!==t?t:null===(r=e[u].data)||void 0===r?void 0:r.hidden,own_capabilities:null!==(l=null===(i=a.channel)||void 0===i?void 0:i.own_capabilities)&&void 0!==l?l:null===(s=e[u].data)||void 0===s?void 0:s.own_capabilities}),(0,c.ev)([],e,!0)):e}),t&&t(),n&&"function"==typeof n&&n(e,a)};return a.on("channel.updated",r),function(){a.off("channel.updated",r)}},[n])},_=t(72775),C=t.n(_),L=t(17056),b=function(e,n){var t=(0,f.mx)("useChannelVisibleListener").client;(0,i.useEffect)(function(){var a=function(a){return(0,c.mG)(void 0,void 0,void 0,function(){var r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:if(!(n&&"function"==typeof n))return[3,1];return n(e,a),[3,3];case 1:if(!(a.type&&a.channel_type&&a.channel_id))return[3,3];return[4,(0,L.m)({client:t,id:a.channel_id,type:a.channel_type})];case 2:r=i.sent(),e(function(e){return C()((0,c.ev)([r],e,!0),"cid")}),i.label=3;case 3:return[2]}})})};return t.on("channel.visible",a),function(){t.off("channel.visible",a)}},[n])},w=function(e){var n=(0,f.mx)("useConnectionRecoveredListener").client;(0,i.useEffect)(function(){var t=function(){e&&e()};return n.on("connection.recovered",t),function(){n.off("connection.recovered",t)}},[])},S=function(e){var n=e.activeChannel,t=e.channels,a=e.cid,r=t.findIndex(function(e){return e.cid===a});if(!n&&r<=0)return t;var i=n||t[r];return C()((0,c.ev)([i],t,!0),"cid")},y=function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!0);var a=(0,f.mx)("useMessageNewListener").client;(0,i.useEffect)(function(){var r=function(r){e(function(e){if(!(e.filter(function(e){return e.cid===r.cid}).length>0)&&t&&r.channel_type){var i=a.channel(r.channel_type,r.channel_id);return C()((0,c.ev)([i],e,!0),"cid")}return n?e:S({channels:e,cid:r.cid||""})})};return a.on("message.new",r),function(){a.off("message.new",r)}},[n])},I=function(e,n,t){(0,i.useEffect)(function(){var a=function(a){t&&e.current&&!e.current.contains(a.target)&&n&&t()};return document.addEventListener("click",a),function(){document.removeEventListener("click",a)}},[e,t,n])},R=function(e,n,t){void 0===t&&(t=!0);var a=(0,f.mx)("useNotificationAddedToChannelListener").client;(0,i.useEffect)(function(){var r=function(r){return(0,c.mG)(void 0,void 0,void 0,function(){var i,l,s;return(0,c.Jh)(this,function(u){switch(u.label){case 0:if(!(n&&"function"==typeof n))return[3,1];return n(e,r),[3,3];case 1:if(!(t&&(null===(l=r.channel)||void 0===l?void 0:l.type)))return[3,3];return[4,(0,L.m)({client:a,id:r.channel.id,members:null===(s=r.channel.members)||void 0===s?void 0:s.reduce(function(e,n){var t=n.user,a=n.user_id||(null==t?void 0:t.id);return a&&e.push(a),e},[]),type:r.channel.type})];case 2:i=u.sent(),e(function(e){return C()((0,c.ev)([i],e,!0),"cid")}),u.label=3;case 3:return[2]}})})};return a.on("notification.added_to_channel",r),function(){a.off("notification.added_to_channel",r)}},[n])},N=function(e,n,t){void 0===t&&(t=!0);var a=(0,f.mx)("useNotificationMessageNewListener").client;(0,i.useEffect)(function(){var r=function(r){return(0,c.mG)(void 0,void 0,void 0,function(){var i,l;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!(n&&"function"==typeof n))return[3,1];return n(e,r),[3,3];case 1:if(!(t&&(null===(l=r.channel)||void 0===l?void 0:l.type)))return[3,3];return[4,(0,L.m)({client:a,id:r.channel.id,type:r.channel.type})];case 2:i=s.sent(),e(function(e){return C()((0,c.ev)([i],e,!0),"cid")}),s.label=3;case 3:return[2]}})})};return a.on("notification.message_new",r),function(){a.off("notification.message_new",r)}},[n])},x=function(e,n){var t=(0,f.mx)("useNotificationRemovedFromChannelListener").client;(0,i.useEffect)(function(){var a=function(t){n&&"function"==typeof n?n(e,t):e(function(e){return e.filter(function(e){var n;return e.cid!==(null===(n=t.channel)||void 0===n?void 0:n.cid)})})};return t.on("notification.removed_from_channel",a),function(){t.off("notification.removed_from_channel",a)}},[n])},k=function(e,n,t,a,r,l){void 0===l&&(l=5e3);var s=(0,f.mx)("usePaginatedChannels").channelsQueryState,u=s.error,o=s.setError,d=s.setQueryInProgress,h=(0,i.useState)([]),v=h[0],m=h[1],p=(0,i.useState)(!0),E=p[0],g=p[1],_=(0,i.useRef)(),L=l<2e3?2e3:l||5e3,b=(0,i.useMemo)(function(){return JSON.stringify(n)},[n]),w=(0,i.useMemo)(function(){return JSON.stringify(t)},[t]),S=function(i){return(0,c.mG)(void 0,void 0,void 0,function(){var l,s,u,h,f,p;return(0,c.Jh)(this,function(E){switch(E.label){case 0:o(null),"reload"===i?(m([]),d("reload")):d("load-more"),l="reload"===i?0:v.length,s=(0,c.pi)({limit:null!==(p=null==a?void 0:a.limit)&&void 0!==p?p:30,offset:l},a),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,e.queryChannels(n,t||{},s)];case 2:return u=E.sent(),m(h="reload"===i?u:C()((0,c.ev)((0,c.ev)([],v,!0),u,!0),"cid")),g(u.length>=s.limit),!l&&r&&r(h,m),[3,4];case 3:return console.warn(f=E.sent()),o(f),[3,4];case 4:return d(null),[2]}})})},y=(0,i.useCallback)(function(){var e=Date.now(),n=!_.current,t=_.current?e-_.current:0;(n||!(t<L)||u)&&(_.current=e,S("reload"))},[u,S,L]);return(0,i.useEffect)(function(){if(!e.recoverStateOnReconnect){var n=e.on("connection.recovered",y).unsubscribe;return function(){n()}}},[e,y]),(0,i.useEffect)(function(){S("reload")},[b,w]),{channels:v,hasNextPage:E,loadNextPage:function(){S()},setChannels:m}},M=function(e){var n=(0,f.mx)("useUserPresenceChangedListener").client;(0,i.useEffect)(function(){var t=function(n){e(function(e){var t=e.map(function(e){var t;return(null===(t=n.user)||void 0===t?void 0:t.id)&&e.state.members[n.user.id]&&(e.state.members[n.user.id].user=n.user),e});return(0,c.ev)([],t,!0)})};return n.on("user.presence.changed",t),function(){n.off("user.presence.changed",t)}},[])},H=t(8229),P=i.memo(function(e){var n,t,a=e.active,r=e.Avatar,c=void 0===r?H.q:r,s=e.channel,u=e.className,o=e.displayImage,d=e.displayTitle,h=e.latestMessage,v=e.onSelect,f=e.setActiveChannel,m=e.unread,p=e.watchers,E=(0,i.useRef)(null),g=d||(null===(t=null===(n=s.state.messages[s.state.messages.length-1])||void 0===n?void 0:n.user)||void 0===t?void 0:t.id);return i.createElement("button",{"aria-label":"Select Channel: ".concat(d||""),"aria-selected":a,className:(0,l.Z)("str-chat__channel-preview-messenger str-chat__channel-preview",a&&"str-chat__channel-preview-messenger--active",m&&m>=1&&"str-chat__channel-preview-messenger--unread",void 0===u?"":u),"data-testid":"channel-preview-button",onClick:function(e){v?v(e):f&&f(s,p),(null==E?void 0:E.current)&&E.current.blur()},ref:E,role:"option"},i.createElement("div",{className:"str-chat__channel-preview-messenger--left"},i.createElement(c,{image:o,name:g,size:40})),i.createElement("div",{className:"str-chat__channel-preview-messenger--right str-chat__channel-preview-end"},i.createElement("div",{className:"str-chat__channel-preview-end-first-row"},i.createElement("div",{className:"str-chat__channel-preview-messenger--name"},i.createElement("span",null,d)),!!m&&i.createElement("div",{className:"str-chat__channel-preview-unread-badge","data-testid":"unread-badge"},m)),i.createElement("div",{className:"str-chat__channel-preview-messenger--last-message"},h)))}),A=function(e){var n=(0,f.mx)("useIsChannelMuted").client,t=(0,i.useState)(e.muteStatus()),a=t[0],r=t[1];return(0,i.useEffect)(function(){var t=function(){return r(e.muteStatus())};return n.on("notification.channel_mutes_updated",t),function(){return n.off("notification.channel_mutes_updated",t)}},[a]),a},D=t(22439),F=t(45966);(a=r||(r={})).DELIVERED="delivered",a.READ="read";var Z=function(e){var n=e.channel,t=e.lastMessage,a=(0,f.mx)().client,c=(0,i.useState)(),l=c[0],s=c[1],u=(0,i.useCallback)(function(e){var n;return a.user&&(null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.id)===a.user.id},[a]);return(0,i.useEffect)(function(){var e=u(t);if((null==t?void 0:t.created_at)&&e){var c="string"==typeof t.created_at?new Date(t.created_at):t.created_at;s(Object.values(n.state.read).some(function(e){var n=e.last_read,t=e.user;return a.user&&t.id!==a.user.id&&c<n})?r.READ:r.DELIVERED)}},[n.state.read,a,u,t]),(0,i.useEffect)(function(){var e=function(e){return u(e.message)?s(r.DELIVERED):s(void 0)};return n.on("message.new",e),function(){n.off("message.new",e)}},[n,a,u]),(0,i.useEffect)(function(){if(u(t)){var e=function(e){var n,t;(null===(n=e.user)||void 0===n?void 0:n.id)!==(null===(t=a.user)||void 0===t?void 0:t.id)&&s(r.READ)};return n.on("message.read",e),function(){n.off("message.read",e)}}},[n,a,t,u]),{messageDeliveryStatus:l}},q=function(e){var n=e.channel,t=e.Preview,a=void 0===t?P:t,r=e.channelUpdateCount,l=(0,f.mx)("ChannelPreview"),u=l.channel,o=l.client,d=l.setActiveChannel,h=(0,s.Ht)("ChannelPreview"),v=h.t,m=h.userLanguage,p=(0,D.y)({channel:n}),E=p.displayImage,g=p.displayTitle,_=(0,i.useState)(n.state.messages[n.state.messages.length-1]),C=_[0],L=_[1],b=(0,i.useState)(0),w=b[0],S=b[1],y=Z({channel:n,lastMessage:C}).messageDeliveryStatus,I=(null==u?void 0:u.cid)===n.cid,R=A(n).muted;(0,i.useEffect)(function(){var e=function(e){if(!e.cid)return S(0);n.cid===e.cid&&S(0)};return o.on("notification.mark_read",e),function(){return o.off("notification.mark_read",e)}},[]);var N=(0,i.useCallback)(function(){I||R?S(0):S(n.countUnread())},[n,I,R]);if((0,i.useEffect)(function(){N();var e=function(e){e.message&&L(e.message),N()};return n.on("message.new",e),n.on("message.updated",e),n.on("message.deleted",e),function(){n.off("message.new",e),n.off("message.updated",e),n.off("message.deleted",e)}},[N,r]),!a)return null;var x=(0,F.x4)(n,v,m);return i.createElement(a,(0,c.pi)({},e,{active:I,displayImage:E,displayTitle:g,lastMessage:C,latestMessage:x,messageDeliveryStatus:y,setActiveChannel:d,unread:w}))},T=t(81739),B=t.n(T),V=function(e){return null!=e.cid},U=function(e){var n=e.channelType,t=void 0===n?"messaging":n,a=e.clearSearchOnClickOutside,r=void 0===a||a,l=e.disabled,s=void 0!==l&&l,u=e.onSearch,o=e.onSearchExit,d=e.onSelectResult,h=e.searchDebounceIntervalMs,v=void 0===h?300:h,m=e.searchForChannels,p=void 0!==m&&m,E=e.searchFunction,g=e.searchQueryParams,_=e.setChannels,L=(0,f.mx)("useChannelSearch"),b=L.client,w=L.setActiveChannel,S=L.themeVersion,y=(0,i.useState)(!1),I=y[0],R=y[1],N=(0,i.useState)(""),x=N[0],k=N[1],M=(0,i.useState)([]),H=M[0],P=M[1],A=(0,i.useState)(!1),D=A[0],F=A[1],Z=(0,i.useRef)(),q=(0,i.useRef)(!1),T=(0,i.useRef)(null),U=(0,i.useRef)(null),J=(0,i.useCallback)(function(){k(""),P([]),F(!1),Z.current&&(q.current=!0)},[]),O=(0,i.useCallback)(function(){R(!0)},[]),z=(0,i.useCallback)(function(){var e;R(!1),null===(e=T.current)||void 0===e||e.blur(),J(),null==o||o()},[J,o]);(0,i.useEffect)(function(){if(!s){var e=function(e){var n,t;e.target instanceof HTMLElement&&(("2"===S?null===(n=U.current)||void 0===n?void 0:n.contains(e.target):null===(t=T.current)||void 0===t?void 0:t.contains(e.target))||(!I||x)&&!r||z())};return document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}}},[s,I,x,z,r]),(0,i.useEffect)(function(){if(T.current&&!s){var e=function(e){if("Escape"===e.key)return z()};return T.current.addEventListener("keydown",e),function(){var n;null===(n=T.current)||void 0===n||n.removeEventListener("keydown",e)}}},[s]);var G=(0,i.useCallback)(function(e){return(0,c.mG)(void 0,void 0,void 0,function(){var n,a;return(0,c.Jh)(this,function(i){switch(i.label){case 0:if(!b.userID)return[2];if(!d)return[3,2];return[4,d({setQuery:k,setResults:P,setSearching:F},e)];case 1:return i.sent(),[2];case 2:if(!V(e))return[3,3];return w(e),n=e,[3,5];case 3:return[4,(a=b.channel(t,{members:[b.userID,e.id]})).watch()];case 4:i.sent(),w(a),n=a,i.label=5;case 5:return _(function(e){return C()((0,c.ev)([n],e,!0),"cid")}),r&&z(),[2]}})})},[r,b,z,d,w,_]),Q=(0,i.useCallback)(function(e){return(0,c.mG)(void 0,void 0,void 0,function(){var n,t,a,r,i,l,s,u,o,d,h,v;return(0,c.Jh)(this,function(f){switch(f.label){case 0:n=[],f.label=1;case 1:if(f.trys.push([1,6,,7]),t=b.queryUsers((0,c.pi)({$or:[{id:{$autocomplete:e}},{name:{$autocomplete:e}}],id:{$ne:b.userID}},null===(s=null==g?void 0:g.userFilters)||void 0===s?void 0:s.filters),(0,c.pi)({id:1},null===(u=null==g?void 0:g.userFilters)||void 0===u?void 0:u.sort),(0,c.pi)({limit:8},null===(o=null==g?void 0:g.userFilters)||void 0===o?void 0:o.options)),p)return[3,3];return Z.current=t,[4,Z.current];case 2:return n=a=f.sent().users,[3,5];case 3:return r=b.queryChannels((0,c.pi)({name:{$autocomplete:e}},null===(d=null==g?void 0:g.channelFilters)||void 0===d?void 0:d.filters),(null===(h=null==g?void 0:g.channelFilters)||void 0===h?void 0:h.sort)||{},(0,c.pi)({limit:5},null===(v=null==g?void 0:g.channelFilters)||void 0===v?void 0:v.options)),Z.current=Promise.all([r,t]),[4,Z.current];case 4:l=(i=f.sent())[0],a=i[1].users,n=(0,c.ev)((0,c.ev)([],l,!0),a,!0),f.label=5;case 5:return[3,7];case 6:return console.error(f.sent()),[3,7];case 7:return F(!1),q.current?q.current=!1:P(n),Z.current=void 0,[2]}})})},[b,p,g]),$=(0,i.useCallback)(B()(Q,v),[Q,v]),W=(0,i.useCallback)(function(e){e.preventDefault(),s||(E?E({setQuery:k,setResults:P,setSearching:F},e):e.target.value?(F(!0),k(e.target.value),$(e.target.value)):e.target.value||(J(),$.cancel()),null==u||u(e))},[J,s,$,u,E]);return{activateSearch:O,clearState:J,exitSearch:z,inputIsFocused:I,inputRef:T,onSearch:W,query:x,results:H,searchBarRef:U,searching:D,selectResult:G}},J=function(){return i.createElement("svg",{"data-testid":"menu-icon",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{clipRule:"evenodd",d:"M3 8V6H21V8H3ZM3 13H21V11H3V13ZM3 18H21V16H3V18Z",fill:"black",fillRule:"evenodd"}))},O=function(){return i.createElement("svg",{"data-testid":"return-icon",fill:"none",height:"20",viewBox:"0 0 22 22",width:"20",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M21.6668 9.66666V12.3333H5.6529L12.9932 19.6736L11.1076 21.5592L0.54834 11L11.1076 0.440765L12.9932 2.32638L5.6529 9.66666H21.6668Z",fill:"#080707"}))},z=function(){return i.createElement("svg",{fill:"none",height:"14",viewBox:"0 0 14 14",width:"14",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z",fill:"#747881"}))},G=function(e){var n=e.className;return i.createElement("svg",{className:n,fill:"none",height:"18",viewBox:"0 0 18 18",width:"18",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M12.7549 11.255H11.9649L11.6849 10.985C12.6649 9.845 13.2549 8.365 13.2549 6.755C13.2549 3.165 10.3449 0.255005 6.75488 0.255005C3.16488 0.255005 0.254883 3.165 0.254883 6.755C0.254883 10.345 3.16488 13.255 6.75488 13.255C8.36488 13.255 9.84488 12.665 10.9849 11.685L11.2549 11.965V12.755L16.2549 17.745L17.7449 16.255L12.7549 11.255ZM6.75488 11.255C4.26488 11.255 2.25488 9.245 2.25488 6.755C2.25488 4.26501 4.26488 2.255 6.75488 2.255C9.24488 2.255 11.2549 4.26501 11.2549 6.755C11.2549 9.245 9.24488 11.255 6.75488 11.255Z",fill:"#747881"}))},Q=function(e){var n=e.disabled,t=e.inputRef,a=e.onSearch,r=e.placeholder,c=e.query,l=(0,s.Ht)("SearchInput").t;return i.createElement("input",{className:"str-chat__channel-search-input","data-testid":"search-input",disabled:n,onChange:a,placeholder:null!=r?r:l("Search"),ref:t,type:"text",value:c})},$=function(e){var n=e.children,t=e.className,a=e.onClick;return i.createElement("button",{className:(0,l.Z)("str-chat__channel-search-bar-button",t),"data-testid":"search-bar-button",onClick:a},n)},W=function(e){var n=e.activateSearch,t=e.AppMenu,a=e.ClearInputIcon,r=e.exitSearch,s=e.ExitSearchIcon,u=e.inputIsFocused,o=e.MenuIcon,d=e.searchBarRef,h=e.SearchInput,v=void 0===h?Q:h,f=e.SearchInputIcon,m=(0,c._T)(e,["activateSearch","AppMenu","ClearInputIcon","exitSearch","ExitSearchIcon","inputIsFocused","MenuIcon","searchBarRef","SearchInput","SearchInputIcon"]),p=(0,i.useState)(!1),E=p[0],g=p[1],_=(0,i.useRef)(null);(0,i.useEffect)(function(){if(_.current){var e=function(e){E&&"Escape"===e.key&&g(!1)},n=function(e){var n;!(!(e.target instanceof HTMLElement)||!E||(null===(n=_.current)||void 0===n?void 0:n.contains(e.target)))&&g(!1)};return document.addEventListener("keydown",e),document.addEventListener("click",n),function(){document.removeEventListener("keydown",e),document.removeEventListener("click",n)}}},[E]),(0,i.useEffect)(function(){if(e.inputRef.current){var t=function(){n()},a=function(e){e.stopPropagation()};return e.inputRef.current.addEventListener("focus",t),e.inputRef.current.addEventListener("blur",a),function(){var n,r;null===(n=e.inputRef.current)||void 0===n||n.removeEventListener("focus",t),null===(r=e.inputRef.current)||void 0===r||r.addEventListener("blur",a)}}},[]);var C=(0,i.useCallback)(function(){var e;r(),null===(e=m.inputRef.current)||void 0===e||e.focus()},[]),L=(0,i.useCallback)(function(){return g(!1)},[]);return i.createElement("div",{className:"str-chat__channel-search-bar","data-testid":"search-bar",ref:d},u?i.createElement($,{className:"str-chat__channel-search-bar-button--exit-search",onClick:r},i.createElement(void 0===s?O:s,null)):t?i.createElement($,{className:"str-chat__channel-search-bar-button--menu",onClick:function(){return g(function(e){return!e})}},i.createElement(void 0===o?J:o,null)):null,i.createElement("div",{className:(0,l.Z)("str-chat__channel-search-input--wrapper",m.query&&"str-chat__channel-search-input--wrapper-active")},i.createElement("div",{className:"str-chat__channel-search-input--icon"},i.createElement(void 0===f?G:f,null)),i.createElement(v,(0,c.pi)({},m)),i.createElement("button",{className:"str-chat__channel-search-input--clear-button","data-testid":"clear-input-button",disabled:!m.query,onClick:C},i.createElement(void 0===a?z:a,null))),E&&t&&i.createElement("div",{ref:_},i.createElement(t,{close:L})))},j=function(){var e=(0,s.Ht)("SearchResults").t;return i.createElement("div",{"aria-live":"polite",className:"str-chat__channel-search-container-empty"},i.createElement(G,null),e("No results found"))},K=function(e){var n=e.results,t=(0,s.Ht)("SearchResultsHeader").t;return i.createElement("div",{className:"str-chat__channel-search-results-header","data-testid":"channel-search-results-header"},t("searchResultsCount",{count:n.length}))},X=function(e){var n=e.focusedUser,t=e.results,a=e.SearchResultItem,r=void 0===a?Y:a,c=e.selectResult;return i.createElement(i.Fragment,null,t.map(function(e,t){return i.createElement(r,{focusedUser:n,index:t,key:t,result:e,selectResult:c})}))},Y=function(e){var n,t,a=e.focusedUser,r=e.index,c=e.result,s=e.selectResult,u=(0,f.mx)().themeVersion,o=(0,l.Z)("str-chat__channel-search-result",a===r&&"str-chat__channel-search-result--focused focused");return V(c)?"2"===u?i.createElement(q,{channel:c,className:o,onSelect:function(){return s(c)}}):i.createElement("button",{"aria-label":"Select Channel: ".concat((null===(n=c.data)||void 0===n?void 0:n.name)||""),className:o,"data-testid":"channel-search-result-channel",onClick:function(){return s(c)},role:"option"},i.createElement("div",{className:"result-hashtag"},"#"),i.createElement("p",{className:"channel-search__result-text"},null===(t=c.data)||void 0===t?void 0:t.name)):i.createElement("button",{"aria-label":"Select User Channel: ".concat(c.name||""),className:o,"data-testid":"channel-search-result-user",onClick:function(){return s(c)},role:"option"},i.createElement(H.q,{image:c.image,name:c.name||c.id,size:"2"===u?40:void 0,user:c}),i.createElement("div",{className:"str-chat__channel-search-result--display-name"},c.name||c.id))},ee=function(e){var n=e.children,t=e.popupResults;return i.createElement("div",{"aria-label":"Channel search results",className:(0,l.Z)("str-chat__channel-search-container str-chat__channel-search-result-list",t?"popup":"inline")},n)},en=function(e){var n=e.popupResults,t=e.results,a=e.searching,r=e.SearchEmpty,c=e.SearchResultsHeader,l=e.SearchLoading,u=e.SearchResultItem,o=e.SearchResultsList,d=e.selectResult,h=(0,s.Ht)("SearchResults").t,v=(0,i.useState)(),f=v[0],m=v[1],p=(0,i.useCallback)(function(e){if("ArrowUp"===e.key&&m(function(e){return void 0===e?0:0===e?t.length-1:e-1}),"ArrowDown"===e.key&&m(function(e){return void 0===e?0:e===t.length-1?0:e+1}),"Enter"===e.key&&(e.preventDefault(),void 0!==f))return d(t[f]),m(void 0)},[f]);return((0,i.useEffect)(function(){return document.addEventListener("keydown",p,!1),function(){return document.removeEventListener("keydown",p)}},[p]),a)?i.createElement(ee,{popupResults:n},l?i.createElement(l,null):i.createElement("div",{className:"str-chat__channel-search-container-searching","data-testid":"search-in-progress-indicator"},h("Searching..."))):t.length?i.createElement(ee,{popupResults:n},i.createElement(void 0===c?K:c,{results:t}),i.createElement(void 0===o?X:o,{focusedUser:f,results:t,SearchResultItem:void 0===u?Y:u,selectResult:d})):i.createElement(ee,{popupResults:n},i.createElement(void 0===r?j:r,null))},et=i.memo(function(e){var n=e.AppMenu,t=e.ClearInputIcon,a=e.ExitSearchIcon,r=e.MenuIcon,s=e.placeholder,u=e.popupResults,o=void 0!==u&&u,d=e.SearchBar,h=e.SearchEmpty,v=e.SearchInput,m=void 0===v?Q:v,p=e.SearchLoading,E=e.SearchInputIcon,g=e.SearchResultItem,_=e.SearchResultsList,C=e.SearchResultsHeader,L=(0,c._T)(e,["AppMenu","ClearInputIcon","ExitSearchIcon","MenuIcon","placeholder","popupResults","SearchBar","SearchEmpty","SearchInput","SearchLoading","SearchInputIcon","SearchResultItem","SearchResultsList","SearchResultsHeader"]),b=(0,f.mx)("ChannelSearch").themeVersion,w=U(L),S=w.activateSearch,y=w.clearState,I=w.exitSearch,R=w.inputIsFocused,N=w.inputRef,x=w.onSearch,k=w.query,M=w.results,H=w.searchBarRef,P=w.searching,A=w.selectResult;return i.createElement("div",{className:(0,l.Z)("str-chat__channel-search",o?"str-chat__channel-search--popup":"str-chat__channel-search--inline",{"str-chat__channel-search--with-results":M.length>0}),"data-testid":"channel-search"},"2"===b?i.createElement(void 0===d?W:d,{activateSearch:S,AppMenu:n,ClearInputIcon:t,clearState:y,disabled:L.disabled,exitSearch:I,ExitSearchIcon:a,inputIsFocused:R,inputRef:N,MenuIcon:r,onSearch:x,placeholder:s,query:k,searchBarRef:H,SearchInput:m,SearchInputIcon:E}):i.createElement(m,{clearState:y,disabled:L.disabled,inputRef:N,onSearch:x,placeholder:s,query:k}),k&&i.createElement(en,{popupResults:o,results:M,SearchEmpty:h,searching:P,SearchLoading:p,SearchResultItem:g,SearchResultsHeader:C,SearchResultsList:_,selectResult:A}))}),ea=t(55840),er=t(47311),ec=t(74935),ei=i.memo(function(e){var n=e.children,t=e.isLoading,a=e.onClick,r=e.refreshing,c=(0,s.Ht)("UnMemoizedLoadMoreButton").t,l=null!=n?n:c("Load more"),u=void 0!==t?t:r;return(0,i.useEffect)(function(){(0,ec.b)([[{refreshing:r},{isLoading:t}]],"LoadMoreButton")},[]),i.createElement("div",{className:"str-chat__load-more-button"},i.createElement("button",{"aria-label":"Load More Channels",className:"str-chat__load-more-button__button str-chat__cta-button","data-testid":"load-more-button",disabled:u,onClick:a},u?i.createElement(er.T,null):l))}),el=i.memo(function(e){var n=e.children,t=e.hasNextPage,a=e.isLoading,r=e.LoadMoreButton,c=e.loadNextPage,l=e.refreshing,s=e.reverse,u=void 0!==a?a:l;return(0,i.useEffect)(function(){(0,ec.b)([[{refreshing:l},{isLoading:a}]],"LoadMorePaginator")},[]),i.createElement(i.Fragment,null,!s&&n,t&&i.createElement(void 0===r?ei:r,{isLoading:u,onClick:c}),s&&n)}),es=(0,i.createContext)(void 0),eu=function(e){var n=e.children,t=e.value;return i.createElement(es.Provider,{value:t},n)},eo={},ed={},eh={},ev=i.memo(function(e){var n,t,a=e.additionalChannelSearchProps,r=e.Avatar,s=void 0===r?H.q:r,u=e.allowNewMessagesFromUnfilteredChannels,d=e.channelRenderFilterFn,_=e.ChannelSearch,C=e.customActiveChannel,L=e.EmptyStateIndicator,P=void 0===L?ea.D:L,A=e.filters,D=e.LoadingErrorIndicator,F=e.LoadingIndicator,Z=e.List,T=e.lockChannelOrder,B=e.onAddedToChannel,V=e.onChannelDeleted,U=e.onChannelHidden,J=e.onChannelTruncated,O=e.onChannelUpdated,z=e.onChannelVisible,G=e.onMessageNew,Q=e.onRemovedFromChannel,$=e.options,W=e.Paginator,j=e.Preview,K=e.recoveryThrottleIntervalMs,X=e.renderChannels,Y=e.sendChannelsToList,ee=e.setActiveChannelOnMount,en=void 0===ee||ee,er=e.showChannelSearch,ec=e.sort,ei=e.watchers,es=void 0===ei?{}:ei,ev=(0,f.mx)("ChannelList"),ef=ev.channel,em=ev.channelsQueryState,ep=ev.client,eE=ev.closeMobileNav,eg=ev.customClasses,e_=ev.navOpen,eC=void 0!==e_&&e_,eL=ev.setActiveChannel,eb=ev.theme,ew=ev.useImageFlagEmojisOnWindows,eS=(0,i.useRef)(null),ey=(0,i.useState)(0),eI=ey[0],eR=ey[1],eN=(0,i.useState)(!1),ex=eN[0],ek=eN[1],eM=function(){return eR(function(e){return e+1})},eH=(0,i.useCallback)(function(e){var n;e.target.value?ek(!0):ek(!1),null===(n=null==a?void 0:a.onSearch)||void 0===n||n.call(a,e)},[]),eP=(0,i.useCallback)(function(){var e;ek(!1),null===(e=null==a?void 0:a.onSearchExit)||void 0===e||e.call(a)},[]),eA=k(ep,A||eo,(void 0===ec?eh:ec)||eh,$||ed,function(e,n){return(0,c.mG)(void 0,void 0,void 0,function(){var t;return(0,c.Jh)(this,function(a){switch(a.label){case 0:if(!e.length||e.length>((null==$?void 0:$.limit)||30))return[2];if(!C)return[3,3];if(t=e.find(function(e){return e.id===C}))return[3,2];return[4,ep.queryChannels({id:C})];case 1:t=a.sent()[0],a.label=2;case 2:return t&&(eL(t,es),n(S({activeChannel:t,channels:e,cid:t.cid}))),[2];case 3:return en&&eL(e[0],es),[2]}})})},K),eD=eA.channels,eF=eA.hasNextPage,eZ=eA.loadNextPage,eq=eA.setChannels,eT=d?d(eD):eD;I(eS,eC,eE),y(eq,T,u),N(eq,G,u),R(eq,B,u),x(eq,Q),m(eq,V),p(eq,U),b(eq,z),E(eq,J,eM),g(eq,O,eM),w(eM),M(eq),(0,i.useEffect)(function(){var e=function(e){e.cid===(null==ef?void 0:ef.cid)&&eL()};return ep.on("channel.deleted",e),ep.on("channel.hidden",e),function(){ep.off("channel.deleted",e),ep.off("channel.hidden",e)}},[null==ef?void 0:ef.cid]);var eB=function(e){var n={activeChannel:ef,Avatar:s,channel:e,channelUpdateCount:eI,key:e.id,Preview:j,setActiveChannel:eL,watchers:es};return i.createElement(q,(0,c.pi)({},n))},eV=(0,l.Z)(null!==(n=null==eg?void 0:eg.chat)&&void 0!==n?n:"str-chat",eb,null!==(t=null==eg?void 0:eg.channelList)&&void 0!==t?t:"str-chat-channel-list str-chat__channel-list str-chat__channel-list-react",{"str-chat--windows-flags":ew&&navigator.userAgent.match(/Win/),"str-chat-channel-list--open":eC}),eU=!ex||(null==a?void 0:a.popupResults);return i.createElement(eu,{value:{channels:eD,setChannels:eq}},i.createElement("div",{className:eV,ref:eS},void 0!==er&&er&&i.createElement(void 0===_?et:_,(0,c.pi)({onSearch:eH,onSearchExit:eP,setChannels:eq},a)),eU&&i.createElement(void 0===Z?v:Z,{error:em.error,loadedChannels:void 0!==Y&&Y?eT:void 0,loading:!!em.queryInProgress&&["reload","uninitialized"].includes(em.queryInProgress),LoadingErrorIndicator:void 0===D?o:D,LoadingIndicator:void 0===F?h:F,setChannels:eq},(null==eT?void 0:eT.length)?i.createElement(void 0===W?el:W,{hasNextPage:eF,isLoading:"load-more"===em.queryInProgress,loadNextPage:eZ},X?X(eT,eB):eT.map(function(e){return eB(e)})):i.createElement(P,{listType:"channel"}))))})}}]);